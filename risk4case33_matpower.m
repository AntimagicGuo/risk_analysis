function mpc = risk4case33_matpower(mc_epoch,example_n)
%CASE30    Power flow data for 30 bus, 6 generator case.
%   Please see CASEFORMAT for details on the case file format.
%
%   Based on data from ...
%     Alsac, O. & Stott, B., "Optimal Load Flow with Steady State Security",
%     IEEE Transactions on Power Apparatus and Systems, Vol. PAS 93, No. 3,
%     1974, pp. 745-751.
%   ... with branch parameters rounded to nearest 0.01, shunt values divided
%   by 100 and shunt on bus 10 moved to bus 5, load at bus 5 zeroed out.
%   Generator locations, costs and limits and bus areas were taken from ...
%     Ferrero, R.W., Shahidehpour, S.M., Ramesh, V.C., "Transaction analysis
%     in deregulated power systems using game theory", IEEE Transactions on
%     Power Systems, Vol. 12, No. 3, Aug 1997, pp. 1340-1347.
%   Generator Q limits were derived from Alsac & Stott, using their Pmax
%   capacities. V limits and line |S| limits taken from Alsac & Stott.

%   MATPOWER
%%
str = num2str(example_n);
data_dir = 'F:\1硬盘备份\u盘\1论文-风险分析\论文\risk4matcode\data_case2_(0.1-2)\';
filename_p_load = strcat(data_dir ,'p_sample_',str);
            virable_name_p = strcat('p_sample_',str);
filename_q_load = strcat(data_dir ,'q_sample_',str);
           virable_name_q = strcat('q_sample_',str);
load(filename_p_load);
load(filename_q_load);
x3 = load('p_wind_out.mat');
% x4 = load('p_wind_out.mat');
%         eval([x1,virable_name_p]);%p_load_out = x1.q_load_out;
%         p_load_out = x1;
%         eval([x2,virable_name_q]);%q_load_out = x2.q_load_out;
%         q_load_out = x2;
eval(['p_load_out=',virable_name_p]);eval(['q_load_out=',virable_name_q]);

rnd = unidrnd(2000); col_min_1 = (rnd-1)*10+1;col_max_1 = (rnd)*10;
p_wind_out_1 = x3.p_wind_out(col_min_1 :col_max_1);
q_wind_out_1 = p_wind_out_1.*0.8;

rnd = unidrnd(2000); col_min_2 = (rnd-1)*10+1;col_max_2 = (rnd)*10;
p_wind_out_2 = x3.p_wind_out(col_min_2 :col_max_2);
q_wind_out_2 = p_wind_out_2.*0.8;

rnd = unidrnd(2000); col_min_3 = (rnd-1)*10+1;col_max_3 = (rnd)*10;
p_wind_out_3 = x3.p_wind_out(col_min_3 :col_max_3);
q_wind_out_3 = p_wind_out_3.*0.8;

% q_wind_out = x4.p_wind_out(col_min :col_max);

%% MATPOWER Case Format : Version 2
mpc.version = '2';

%%-----  Power Flow Data  -----%%
%% system MVA base
mpc.baseMVA = 10;

%% bus data （pd's unit is MW，Qd's unit is Mvar)
%	bus_i	type	Pd	Qd	Gs	Bs	area	Vm	Va	baseKV	zone	Vmax	Vmin
mpc.bus = [
	1	3	0	     0	    0	0	1	1	0	10	1	2.0 	0.1;
	2	1	0.1	    0.06	0	0	1	1	0	10	1	2.0 	0.1;
	3	1	0.09	0.04	0	0	1	1	0	10	1	2.0 	0.1;
	4	1	0.12	0.08	0	0	1	1	0	10	1	2.0 	0.1;
	5	1	0.06	0.03	0	0	1	1	0	10	1	2.0 	0.1;
	6	1	0.06	0.02	0	0	1	1	0	10	1	2.0 	0.1;
	7	1	0.2	     0.1	0	0	1	1	0	10	1	2.0 	0.1;
	8	1	0.2	     0.1	0	0	1	1	0	10	1	2.0 	0.1;
	9	1	0.06	0.02	0	0	1	1	0	10	1	2.0 	0.1;
	10	1	0.06	0.02	0	0	1	1	0	10	1	2.0 	0.1;
	11	1	0.045	0.03	0	0	1	1	0	10	1	2.0 	0.1;
	12	1	0.06	0.035	0	0	1	1	0	10	1	2.0 	0.1;
	13	1	0.06	0.035	0	0	1	1	0	10	1	2.0 	0.1;
	14	1	0.12	0.08	0	0	1	1	0	10	1	2.0 	0.1;
	15	1	0.06	0.01	0	0	1	1	0	10	1	2.0 	0.1;
	16	1	0.06	0.02	0	0	1	1	0	10	1	2.0 	0.1;
	17	1	0.06	0.02	0	0	1	1	0	10	1   2.0	    0.1;
	18	1	0.00	0.00    0	0	1	1	0	10	1	2.0 	0.1;
	19	1	0.09	0.04	0	0	1	1	0	10	1	2.0 	0.1;
	20	1	0.09	0.04	0	0	1	1	0	10	1	2.0 	0.1;
	21	1	0.09	0.04	0	0	1	1	0	10	1	2.0 	0.1;
	22	1	0.09	0.04	0	0	1	1	0	10	1	2.0 	0.1;
	23	1	0.09	0.05	0	0	1	1	0	10	1	2.0 	0.1;
	24	1	0.42	0.2	    0	0	3	1	0	10	1	2.0 	0.1;
	25	1	0.42	0.2   	0	0	3	1	0	10	1	2.0 	0.1;
	26	1	0.06	0.025	0	0	1	1	0	10	1	2.0 	0.1;
	27	1	0.06	0.025	0	0	1	1	0	10	1	2.0 	0.1;
	28	1	0.06	0.02	0	0	1	1	0	10	1	2.0 	0.1;
	29	1	0.12	0.07	0	0	1	1	0	10	1	2.0 	0.1;
	30	1	0.2		0.6  	0	0	1	1	0   10	1	2.0 	0.1;
    31  1	0.15	0.7     0	0	1	1	0   10	1	2.0 	0.1;
    32  1	0.21	0.1  	0	0	1	1	0   10	1	2.0 	0.1;
    33  1	0.06	0.04	0	0	1	1	0	10	1	2.0 	0.1;
];

%% 4 mc
for i = 2:33
    mpc.bus(i,3) = p_load_out(i,mc_epoch);mpc.bus(i,4) = q_load_out(i,mc_epoch);
end
%%

%% generator data
%	bus	Pg	Qg	Qmax	Qmin	Vg	mBase	status	Pmax	Pmin	Pc1	Pc2	Qc1min	Qc1max	Qc2min	Qc2max	ramp_agc	ramp_10	ramp_30	ramp_q	apf
mpc.gen = [
	1	1	0	10	-10	1	10	1	80	0	0	0	0	0	0	0	0	0	0	0	0;
	10	0.5	0	10	-10	1	10	1	80	0	0	0	0	0	0	0	0	0	0	0	0;
    18	0.5	0	10	-10	1	10	1	80	0	0	0	0	0	0	0	0	0	0	0	0;
    33	0.5	0	10	-10	1	10	1	80	0	0	0	0	0	0	0	0	0	0	0	0
];
%% 4 mc part
mpc.gen(2,2)=p_wind_out_1(mc_epoch);mpc.gen(2,3)=q_wind_out_1(mc_epoch);
mpc.gen(3,2)=p_wind_out_2(mc_epoch);mpc.gen(3,3)=q_wind_out_2(mc_epoch);
mpc.gen(4,2)=p_wind_out_3(mc_epoch);mpc.gen(4,3)=q_wind_out_3(mc_epoch);
%% branch data
%	fbus	tbus	r	x	b	rateA	rateB	rateC	ratio	angle	status	angmin	angmax
%   mpc.branch_1 is oringn
mpc.branch_1 = [
	1	2	0.0922	0.0470	0	2 2 2	0	0	1	-360	360;
	2	3	0.4930	0.2511	0	2 2 2	0	0	1	-360	360;
	3	4	0.3660	0.1864	0	2 2 2	0	0	1	-360	360;
	4	5	0.3811	0.1941	0	2 2 2	0	0   1	-360	360;
	5	6	0.8190	0.7070	0	2 2 2	0	0	1	-360	360;
	6	7	0.1872	0.6188	0	2 2 2	0	0	1	-360	360;
	7	8	0.7114	0.2351	0	2 2 2	0	0	1	-360	360;
	8	9	1.0300	0.7400	0	2 2 2	0	0	1	-360	360;
	9	10	1.0440	0.7400	0	2 2 2	0	0	1	-360	360;
	10	11	0.1966	0.0650	0	2 2 2	0	0	1	-360	360;
	11	12	0.3744	0.1238	0	2 2 2	0	0	1	-360	360;
	12	13	1.4680	1.1550	0	2 2 2	0	0	1	-360	360;
	13	14	0.5416	0.7129	0	2 2 2	0	0	1	-360	360;
	14	15	0.5910	0.5260	0	2 2 2	0	0	1	-360	360;
	15	16	0.7463	0.5450	0	2 2 2	0	0	1	-360	360;
	16	17	1.2890	1.7210	0	2 2 2	0	0	1	-360	360;
	17	18	0.3720	0.5740	0	2 2 2	0	0	1	-360	360;
	2	19	0.1640	0.1565	0	2 2 2	0	0	1	-360	360;
	19	20	1.5042	1.3554	0	2 2 2	0	0	1	-360	360;
	20	21	0.4095	0.4784	0	2 2 2	0	0	1	-360	360;
	21	22	0.7089	0.9373	0	2 2 2	0	0	1	-360	360;
	3	23	0.4512	0.3083	0	2 2 2	0	0	1	-360	360;
	23	24	0.8980	0.7091	0	2 2 2	0	0	1	-360	360;
	24	25	0.8960	0.7011	0	2 2 2	0	0	1	-360	360;
	6	26	0.2030	0.1034	0	2 2 2	0	0	1	-360	360;
	26	27	0.2842	0.1447	0	2 2 2	0	0	1	-360	360;
	27	28	1.0590	0.9337	0	2 2 2	0	0	1	-360	360;
	28	29	0.8042	0.7006	0	2 2 2	0	0	1	-360	360;
	29	30	0.5075	0.2585	0	2 2 2	0	0	1	-360	360;
	30	31	0.9744	0.9630	0	2 2 2	0	0	1	-360	360;
	31	32	0.3105	0.3619	0	2 2 2	0	0	1	-360	360;
	32	33	0.3410	0.5362	0	2 2 2	0	0	1	-360	360;
];
%S1 CLOSED,2-19 OPEN
mpc.branch_2 = [
	1	2	0.0922	0.0470	0	2 2 2	0	0	1	-360	360;
	2	3	0.4930	0.2511	0	2 2 2	0	0	1	-360	360;
	3	4	0.3660	0.1864	0	2 2 2	0	0	1	-360	360;
	4	5	0.3811	0.1941	0	2 2 2	0	0   1	-360	360;
	5	6	0.8190	0.7070	0	2 2 2	0	0	1	-360	360;
	6	7	0.1872	0.6188	0	2 2 2	0	0	1	-360	360;
	7	8	0.7114	0.2351	0	2 2 2	0	0	1	-360	360;
	8	9	1.0300	0.7400	0	2 2 2	0	0	1	-360	360;
    8   21  2.0000  2.0000  0	2 2 2	0	0	1	-360	360;% CLOSED  
	9	10	1.0440	0.7400	0	2 2 2	0	0	1	-360	360;
	10	11	0.1966	0.0650	0	2 2 2	0	0	1	-360	360;
	11	12	0.3744	0.1238	0	2 2 2	0	0	1	-360	360;
	12	13	1.4680	1.1550	0	2 2 2	0	0	1	-360	360;
	13	14	0.5416	0.7129	0	2 2 2	0	0	1	-360	360;
	14	15	0.5910	0.5260	0	2 2 2	0	0	1	-360	360;
	15	16	0.7463	0.5450	0	2 2 2	0	0	1	-360	360;
	16	17	1.2890	1.7210	0	2 2 2	0	0	1	-360	360;
	17	18	0.3720	0.5740	0	2 2 2	0	0	1	-360	360;
	%2	19	0.1640	0.1565	0	2 2 2	0	0	1	-360	360;%OPEN
	19	20	1.5042	1.3554	0	2 2 2	0	0	1	-360	360;
	20	21	0.4095	0.4784	0	2 2 2	0	0	1	-360	360;
	21	22	0.7089	0.9373	0	2 2 2	0	0	1	-360	360;
	3	23	0.4512	0.3083	0	2 2 2	0	0	1	-360	360;
	23	24	0.8980	0.7091	0	2 2 2	0	0	1	-360	360;
	24	25	0.8960	0.7011	0	2 2 2	0	0	1	-360	360;
	6	26	0.2030	0.1034	0	2 2 2	0	0	1	-360	360;
	26	27	0.2842	0.1447	0	2 2 2	0	0	1	-360	360;
	27	28	1.0590	0.9337	0	2 2 2	0	0	1	-360	360;
	28	29	0.8042	0.7006	0	2 2 2	0	0	1	-360	360;
	29	30	0.5075	0.2585	0	2 2 2	0	0	1	-360	360;
	30	31	0.9744	0.9630	0	2 2 2	0	0	1	-360	360;
	31	32	0.3105	0.3619	0	2 2 2	0	0	1	-360	360;
	32	33	0.3410	0.5362	0	2 2 2	0	0	1	-360	360;
];
% S2 CLOSED 2-19 OPEN
mpc.branch_3 = [
	1	2	0.0922	0.0470	0	2 2 2	0	0	1	-360	360;
	2	3	0.4930	0.2511	0	2 2 2	0	0	1	-360	360;
	3	4	0.3660	0.1864	0	2 2 2	0	0	1	-360	360;
	4	5	0.3811	0.1941	0	2 2 2	0	0   1	-360	360;
	5	6	0.8190	0.7070	0	2 2 2	0	0	1	-360	360;
	6	7	0.1872	0.6188	0	2 2 2	0	0	1	-360	360;
	7	8	0.7114	0.2351	0	2 2 2	0	0	1	-360	360;
	8	9	1.0300	0.7400	0	2 2 2	0	0	1	-360	360;
	9	10	1.0440	0.7400	0	2 2 2	0	0	1	-360	360;
	10	11	0.1966	0.0650	0	2 2 2	0	0	1	-360	360;
	11	12	0.3744	0.1238	0	2 2 2	0	0	1	-360	360;
	12	13	1.4680	1.1550	0	2 2 2	0	0	1	-360	360;
    12  22  2.0000  2.0000  0   2 2 2   0   0   1	-360	360;%CLOSED
	13	14	0.5416	0.7129	0	2 2 2	0	0	1	-360	360;
	14	15	0.5910	0.5260	0	2 2 2	0	0	1	-360	360;
	15	16	0.7463	0.5450	0	2 2 2	0	0	1	-360	360;
	16	17	1.2890	1.7210	0	2 2 2	0	0	1	-360	360;
	17	18	0.3720	0.5740	0	2 2 2	0	0	1	-360	360;
	%2	19	0.1640	0.1565	0	2 2 2	0	0	1	-360	360;% OPEN
	19	20	1.5042	1.3554	0	2 2 2	0	0	1	-360	360;
	20	21	0.4095	0.4784	0	2 2 2	0	0	1	-360	360;
	21	22	0.7089	0.9373	0	2 2 2	0	0	1	-360	360;
	3	23	0.4512	0.3083	0	2 2 2	0	0	1	-360	360;
	23	24	0.8980	0.7091	0	2 2 2	0	0	1	-360	360;
	24	25	0.8960	0.7011	0	2 2 2	0	0	1	-360	360;
	6	26	0.2030	0.1034	0	2 2 2	0	0	1	-360	360;
	26	27	0.2842	0.1447	0	2 2 2	0	0	1	-360	360;
	27	28	1.0590	0.9337	0	2 2 2	0	0	1	-360	360;
	28	29	0.8042	0.7006	0	2 2 2	0	0	1	-360	360;
	29	30	0.5075	0.2585	0	2 2 2	0	0	1	-360	360;
	30	31	0.9744	0.9630	0	2 2 2	0	0	1	-360	360;
	31	32	0.3105	0.3619	0	2 2 2	0	0	1	-360	360;
	32	33	0.3410	0.5362	0	2 2 2	0	0	1	-360	360;
];
%S3 CLOSED 6-26 OPEN
mpc.branch_4 = [
	1	2	0.0922	0.0470	0	2 2 2	0	0	1	-360	360;
	2	3	0.4930	0.2511	0	2 2 2	0	0	1	-360	360;
	3	4	0.3660	0.1864	0	2 2 2	0	0	1	-360	360;
	4	5	0.3811	0.1941	0	2 2 2	0	0   1	-360	360;
	5	6	0.8190	0.7070	0	2 2 2	0	0	1	-360	360;
	6	7	0.1872	0.6188	0	2 2 2	0	0	1	-360	360;
	7	8	0.7114	0.2351	0	2 2 2	0	0	1	-360	360;
	8	9	1.0300	0.7400	0	2 2 2	0	0	1	-360	360;
	9	10	1.0440	0.7400	0	2 2 2	0	0	1	-360	360;
	10	11	0.1966	0.0650	0	2 2 2	0	0	1	-360	360;
	11	12	0.3744	0.1238	0	2 2 2	0	0	1	-360	360;
	12	13	1.4680	1.1550	0	2 2 2	0	0	1	-360	360;
	13	14	0.5416	0.7129	0	2 2 2	0	0	1	-360	360;
	14	15	0.5910	0.5260	0	2 2 2	0	0	1	-360	360;
	15	16	0.7463	0.5450	0	2 2 2	0	0	1	-360	360;
	16	17	1.2890	1.7210	0	2 2 2	0	0	1	-360	360;
	17	18	0.3720	0.5740	0	2 2 2	0	0	1	-360	360;
	2	19	0.1640	0.1565	0	2 2 2	0	0	1	-360	360;
    18  33  0.5000  0.5000  0	2 2 2	0	0	1	-360	360;%CLOSED
	19	20	1.5042	1.3554	0	2 2 2	0	0	1	-360	360;
	20	21	0.4095	0.4784	0	2 2 2	0	0	1	-360	360;
	21	22	0.7089	0.9373	0	2 2 2	0	0	1	-360	360;
	3	23	0.4512	0.3083	0	2 2 2	0	0	1	-360	360;
	23	24	0.8980	0.7091	0	2 2 2	0	0	1	-360	360;
	24	25	0.8960	0.7011	0	2 2 2	0	0	1	-360	360;
	%6	26	0.2030	0.1034	0	2 2 2	0	0	1	-360	360;%OPEN
	26	27	0.2842	0.1447	0	2 2 2	0	0	1	-360	360;
	27	28	1.0590	0.9337	0	2 2 2	0	0	1	-360	360;
	28	29	0.8042	0.7006	0	2 2 2	0	0	1	-360	360;
	29	30	0.5075	0.2585	0	2 2 2	0	0	1	-360	360;
	30	31	0.9744	0.9630	0	2 2 2	0	0	1	-360	360;
	31	32	0.3105	0.3619	0	2 2 2	0	0	1	-360	360;
	32	33	0.3410	0.5362	0	2 2 2	0	0	1	-360	360;
];
%S4 CLOSED 3-23 OPEN
mpc.branch_5 = [
	1	2	0.0922	0.0470	0	2 2 2	0	0	1	-360	360;
	2	3	0.4930	0.2511	0	2 2 2	0	0	1	-360	360;
	3	4	0.3660	0.1864	0	2 2 2	0	0	1	-360	360;
	4	5	0.3811	0.1941	0	2 2 2	0	0   1	-360	360;
	5	6	0.8190	0.7070	0	2 2 2	0	0	1	-360	360;
	6	7	0.1872	0.6188	0	2 2 2	0	0	1	-360	360;
	7	8	0.7114	0.2351	0	2 2 2	0	0	1	-360	360;
	8	9	1.0300	0.7400	0	2 2 2	0	0	1	-360	360;
	9	10	1.0440	0.7400	0	2 2 2	0	0	1	-360	360;
	10	11	0.1966	0.0650	0	2 2 2	0	0	1	-360	360;
	11	12	0.3744	0.1238	0	2 2 2	0	0	1	-360	360;
	12	13	1.4680	1.1550	0	2 2 2	0	0	1	-360	360;
	13	14	0.5416	0.7129	0	2 2 2	0	0	1	-360	360;
	14	15	0.5910	0.5260	0	2 2 2	0	0	1	-360	360;
	15	16	0.7463	0.5450	0	2 2 2	0	0	1	-360	360;
	16	17	1.2890	1.7210	0	2 2 2	0	0	1	-360	360;
	17	18	0.3720	0.5740	0	2 2 2	0	0	1	-360	360;
	2	19	0.1640	0.1565	0	2 2 2	0	0	1	-360	360;
	19	20	1.5042	1.3554	0	2 2 2	0	0	1	-360	360;
	20	21	0.4095	0.4784	0	2 2 2	0	0	1	-360	360;
	21	22	0.7089	0.9373	0	2 2 2	0	0	1	-360	360;
	%3	23	0.4512	0.3083	0	2 2 2	0	0	1	-360	360;%OPEN
	23	24	0.8980	0.7091	0	2 2 2	0	0	1	-360	360;
    24  28	0.5000	0.5000	0	2 2 2	0	0	1	-360	360;%CLOSED
	24	25	0.8960	0.7011	0	2 2 2	0	0	1	-360	360;
	6	26	0.2030	0.1034	0	2 2 2	0	0	1	-360	360;
	26	27	0.2842	0.1447	0	2 2 2	0	0	1	-360	360;
	27	28	1.0590	0.9337	0	2 2 2	0	0	1	-360	360;
	28	29	0.8042	0.7006	0	2 2 2	0	0	1	-360	360;
	29	30	0.5075	0.2585	0	2 2 2	0	0	1	-360	360;
	30	31	0.9744	0.9630	0	2 2 2	0	0	1	-360	360;
	31	32	0.3105	0.3619	0	2 2 2	0	0	1	-360	360;
	32	33	0.3410	0.5362	0	2 2 2	0	0	1	-360	360;
];

% RANDOM CHOOSE ONE MPC.BRANCH
%--------------------------------%
%--------------------------------%
% mpc.branch=zeros(32,13);
% CHOOSE_N = unidrnd(5);
% CHOOSE_N_str = num2str(CHOOSE_N);
% CHOOSE_name = strcat('mpc.branch_',CHOOSE_N_str );
% eval(['mpc.branch=',CHOOSE_name]);
%--------------------------------%
%--------------------------------%

mpc.branch=mpc.branch_1;
%zb=10,change r&x to pu
mpc.branch(:,3)=mpc.branch(:,3)/10;mpc.branch(:,4)=mpc.branch(:,4)/10;



%%-----  OPF Data  -----%%  %%  算普通潮流没有影响
%% generator cost data
%	1	startup	shutdown	n	x1	y1	...	xn	yn
%	2	startup	shutdown	n	c(n-1)	...	c0
mpc.gencost = [
	2	0	0	3	0.02	2	0;
	2	0	0	3	0.0175	1.75	0;
	2	0	0	3	0.0625	1	0;
	2	0	0	3	0.00834	3.25	0;
	2	0	0	3	0.025	3	0;
	2	0	0	3	0.025	3	0;
];
